<script lang="ts">
  import type { TypeNavigationSkeleton } from '$lib/clients/content_types'
  import type { Entry } from 'contentful'

  import { fly } from 'svelte/transition'
  import { onNavigate } from '$app/navigation'
  
  import Locales from './Locales.svelte'
  import Rich from './Rich.svelte';
  // import Icon from './Icon.svelte'
  // import Footer from './Footer.svelte'
  
  // import { headerState } from '$lib/stores/header.svelte'

  let { navigations }: {
    navigations: { [key: string]: Entry<TypeNavigationSkeleton, "WITHOUT_UNRESOLVABLE_LINKS"> }
    // form: Entry<TypeFormSkeleton, "WITHOUT_UNRESOLVABLE_LINKS">
    // buttons: Entry<TypeNavigationSkeleton, "WITHOUT_UNRESOLVABLE_LINKS">
    // work: Entry<TypeNavigationSkeleton, "WITHOUT_UNRESOLVABLE_LINKS">
  } = $props()

</script>

<footer class="padded bleu-pale flex flex--thick_gapped flex--spaced">
  <nav class="main-nav flex flex--thick_gapped">
    <div class="col col--4of12 col--portrait--12of12">
      {#if navigations.footer.fields.corps}
      <Rich body={navigations.footer.fields.corps} />
      {/if}
    </div>
    {#each navigations.footer.fields.liens as link, i}
    <div class="col col--portrait--12of12" class:col--landscape--6of12={i === navigations.footer.fields.liens.length - 1} class:col--landscape--3of12={i < navigations.footer.fields.liens.length - 1}>
      <hr>
      <a href={link.fields.destination} class="h5" target={link.fields.externe ? '_blank' : undefined}>{link.fields.titre}</a>

      {#each link.fields.sousLiens as souslien}
      <a href={souslien.fields.destination} class="small" target={souslien.fields.externe ? '_blank' : undefined}>{souslien.fields.titre}</a><br>
      {/each}
    </div>
    {/each}
  </nav>

  <div class="svgs">
    <svg class="svg--logo" width="166" height="167" viewBox="0 0 166 167">
<path d="M82.9975 0.681152C60.9995 0.702319 39.908 9.41699 24.3488 24.9138C8.78967 40.4106 0.0332173 61.4243 0 83.346L0 166.681H22.6882V83.346C22.7161 67.4195 29.0806 52.1541 40.3862 40.897C51.6918 29.64 67.0156 23.3102 82.9975 23.2957C88.8907 23.2811 94.753 24.1443 100.39 25.8568C112.769 29.6112 123.616 37.2192 131.339 47.5653C139.063 57.9113 143.257 70.4511 143.307 83.346H166C165.959 61.4258 157.199 40.416 141.641 24.9208C126.082 9.42555 104.994 0.708916 82.9975 0.681152Z"/>
<path d="M98.6005 83.1782H75.9146C76.1725 104.448 84.4351 124.843 99.0616 140.313C113.688 155.783 133.608 165.195 154.866 166.681H166V144H154.866C139.634 142.495 125.487 135.569 115.113 124.335C104.739 113.101 98.8606 98.4545 98.5954 83.1782"/>
<path d="M132.372 83.8578C132.346 70.8734 127.125 58.4283 117.852 49.2492C108.579 40.0702 96.0104 34.9057 82.8997 34.8872C69.7846 34.8991 57.2094 40.0607 47.9309 49.2404C38.6524 58.4202 33.4278 70.869 33.4024 83.8578V166.681H56.1787V83.8578C56.238 78.5154 57.9242 73.3152 61.0165 68.9374C64.1087 64.5596 68.4632 61.2081 73.5102 59.3213C78.5572 57.4345 84.0617 57.1003 89.3037 58.3624C94.5456 59.6245 99.2809 62.4241 102.89 66.395C105.132 68.7123 106.881 71.4522 108.033 74.4521C109.185 77.452 109.716 80.6505 109.595 83.8578C109.586 96.1826 114.221 108.067 122.595 117.185C130.968 126.303 142.476 131.997 154.866 133.153H166V110.5H154.866C148.556 109.409 142.838 106.066 138.722 101.206C134.605 96.3456 132.359 90.2015 132.372 83.8578Z"/>
</svg>
<svg class="svg--bars" height="57" viewBox="0 0 148 57" preserveAspectRatio="none">
<rect y="0.5" width="148" height="22.666"/>
<rect y="34" width="148" height="22.666"/>
</svg>
    <svg class="svg--logotype" width="317" height="84" viewBox="0 0 317 84">
<path d="M9.27076 23.1926H14.9056C15.411 23.1926 15.9921 23.1926 16.5076 23.1421L23.2796 36.8933H30.6733L22.979 21.9014C25.0552 21.2144 26.8503 19.8682 28.0914 18.0675C29.3324 16.2668 29.9516 14.1101 29.8547 11.9253C29.8547 4.43058 23.9619 0.708496 14.9157 0.708496H2.61243V36.8933H9.28078L9.27076 23.1926ZM9.27076 6.03009H14.9056C20.1262 6.03009 23.2292 7.68519 23.2292 11.9228C23.2292 16.1603 20.1262 17.8685 14.9056 17.8685H9.27076V6.03009Z"/>
<path d="M44.6045 21.0203C35.8161 21.743 31.9399 24.846 31.9399 29.6117C31.9399 33.9074 35.3512 37.4172 41.2439 37.4172C43.0101 37.6021 44.7896 37.2273 46.3313 36.3458C47.8729 35.4644 49.0986 34.1208 49.8352 32.505C49.8812 33.9952 50.1242 35.4727 50.5579 36.8992H56.9155C56.1355 34.4246 55.7517 31.8423 55.7783 29.2478V20.8131C55.7783 12.3355 51.0734 9.49274 44.5617 9.49274C41.8258 9.33063 39.1224 10.1539 36.9414 11.8135C34.7604 13.473 33.246 15.859 32.6727 18.5389H39.187C39.3494 17.3121 39.976 16.1942 40.9378 15.4153C41.8995 14.6364 43.1232 14.2559 44.357 14.3519C47.4069 14.3519 49.158 15.8503 49.158 19.8327V20.6084L44.6045 21.0203ZM49.153 26.913C49.211 27.711 49.0972 28.5121 48.8196 29.2624C48.542 30.0128 48.107 30.695 47.5437 31.2631C46.9803 31.8312 46.3018 32.2721 45.5538 32.5561C44.8058 32.84 44.0057 32.9604 43.2072 32.9093C40.0032 32.9093 38.6058 31.1 38.6058 29.1872C38.6058 26.6603 40.933 25.4651 45.9463 25.1037L49.1504 24.8965L49.153 26.913Z"/>
<path d="M67.1889 0.0341797H60.3663V6.75566H67.1889V0.0341797Z"/>
<path d="M67.1397 10.0112H60.4713V36.8921H67.1397V10.0112Z"/>
<path d="M78.6165 0.706055H71.9481V36.8934H78.6165V0.706055Z"/>
<path d="M102.601 0.706055H95.9325V36.8934H102.601V0.706055Z"/>
<path d="M114.778 22.1592C114.778 17.3582 117.002 14.6645 120.724 14.6645C123.981 14.6645 125.737 16.8882 125.737 21.3329V36.8934H132.405V20.35C132.405 12.9589 128.633 9.48442 123.101 9.48442C121.452 9.40118 119.81 9.76077 118.347 10.5259C116.883 11.291 115.651 12.4338 114.778 13.8357V10.01H108.109V36.8934H114.778V22.1592Z"/>
<path d="M155.637 33.3254V36.8934H162.305V0.706055H155.637V13.5274C154.649 12.2517 153.378 11.2227 151.925 10.5211C150.472 9.81958 148.876 9.46471 147.263 9.48441C141.214 9.48441 135.639 14.2855 135.639 23.4428C135.639 32.5396 141.171 37.4013 147.263 37.4013C148.881 37.424 150.482 37.0662 151.936 36.357C153.391 35.6477 154.658 34.6067 155.637 33.3179M148.969 32.2313C145.247 32.2313 142.3 29.1283 142.3 23.4428C142.3 17.7574 145.247 14.6544 148.969 14.6544C152.691 14.6544 155.637 17.7549 155.637 23.453C155.637 29.151 152.691 32.2414 148.969 32.2414"/>
<path d="M184.578 24.7454C184.578 29.5465 182.354 32.2401 178.632 32.2401C175.375 32.2401 173.619 29.9659 173.619 25.5717V10.0112H166.951V26.5547C166.951 33.9483 170.723 37.4202 176.255 37.4202C177.909 37.5058 179.556 37.1427 181.022 36.3692C182.487 35.5956 183.715 34.4405 184.578 33.026V36.8896H191.247V10.0112H184.578V24.7454Z"/>
<path d="M210.188 21.1277L205.071 20.1978C203.573 19.9451 201.764 19.5762 201.764 17.7164C201.764 15.8566 203.533 14.6665 205.951 14.6665C208.329 14.6665 210.085 15.6494 210.449 17.6659H217.117C216.445 12.3418 211.171 9.49902 205.951 9.49902C200.42 9.49902 195.085 12.4454 195.085 18.0904C195.085 22.846 198.704 24.7588 202.322 25.431L207.492 26.4139C209.301 26.7752 210.903 27.1897 210.903 29.0494C210.903 31.0128 209.135 32.2535 206.302 32.2535C203.717 32.2535 201.547 31.22 201.132 28.7386H194.464C195.394 34.4241 200.253 37.4235 206.302 37.4235C212.506 37.4235 217.572 34.2699 217.572 28.7386C217.572 23.9376 214.522 21.863 210.178 21.1403"/>
<path d="M229.072 3.80811H222.404V10.0116H218.682V15.3357H222.404V29.3447C222.404 35.8059 226.487 37.8223 233.775 36.8924V31.8791C230.879 32.2935 229.07 31.5683 229.07 28.6751V15.3357H233.775V10.0116H229.07L229.072 3.80811Z"/>
<path d="M243.619 15.6433V10.0109H236.951V36.8918H243.619V24.3812C243.619 16.0577 248.272 14.9206 253.442 15.6458V9.8037C251.382 9.49954 249.281 9.91451 247.492 10.9787C245.703 12.0428 244.335 13.6886 243.619 15.6433Z"/>
<path d="M262.208 10.0112H255.539V36.8921H262.208V10.0112Z"/>
<path d="M262.259 0.0341797H255.437V6.75566H262.259V0.0341797Z"/>
<path d="M278.733 9.5025C276.927 9.47976 275.135 9.83094 273.471 10.534C271.807 11.237 270.307 12.2767 269.064 13.5876C267.821 14.8986 266.863 16.4525 266.249 18.1516C265.636 19.8508 265.381 21.6584 265.5 23.4609C265.378 25.2728 265.635 27.0901 266.254 28.7973C266.873 30.5045 267.84 32.0642 269.095 33.3771C270.349 34.6901 271.863 35.7275 273.54 36.4234C275.218 37.1194 277.021 37.4585 278.837 37.4194C281.658 37.6054 284.459 36.8266 286.779 35.2107C289.099 33.5949 290.801 31.2381 291.605 28.5273H284.833C284.344 29.6938 283.504 30.679 282.43 31.346C281.355 32.0131 280.099 32.3288 278.837 32.2494C277.11 32.2751 275.443 31.6145 274.202 30.4127C272.961 29.2108 272.248 27.5658 272.219 25.8387V25.4774H291.966C292.328 16.224 287.883 9.5025 278.733 9.5025ZM272.272 20.5146C272.431 18.9109 273.18 17.4234 274.374 16.3415C275.569 15.2595 277.123 14.6603 278.735 14.6603C280.346 14.6603 281.9 15.2595 283.095 16.3415C284.289 17.4234 285.038 18.9109 285.197 20.5146H272.272Z"/>
<path d="M309.289 21.1277L304.17 20.1978C302.671 19.9451 300.862 19.5762 300.862 17.7164C300.862 15.8566 302.631 14.6665 305.049 14.6665C307.427 14.6665 309.183 15.6494 309.547 17.6659H316.216C315.543 12.3418 310.27 9.49902 305.049 9.49902C299.518 9.49902 294.184 12.4454 294.184 18.0904C294.184 22.846 297.802 24.7588 301.421 25.431L306.59 26.4139C308.4 26.7752 310.002 27.1897 310.002 29.0494C310.002 31.0128 308.233 32.2535 305.4 32.2535C302.815 32.2535 300.645 31.22 300.233 28.7386H293.562C294.492 34.4241 299.354 37.4235 305.4 37.4235C311.604 37.4235 316.67 34.2699 316.67 28.7386C316.67 23.9376 313.62 21.863 309.279 21.1403"/>
<path d="M18.9381 51.1274C21.095 51.0329 23.2251 51.6356 25.0128 52.8462C26.8005 54.0568 28.1507 55.8109 28.8636 57.8489H35.5321C33.7633 50.7155 27.7771 45.8032 18.9381 45.8032C14.0554 45.8837 9.40001 47.8798 5.97553 51.3612C2.55105 54.8426 0.631836 59.5303 0.631836 64.4136C0.631836 69.297 2.55105 73.9847 5.97553 77.4661C9.40001 80.9475 14.0554 82.9436 18.9381 83.024C27.676 83.024 33.6723 78.223 35.5321 71.1351H28.8105C28.076 73.1373 26.723 74.8535 24.9474 76.0348C23.1718 77.2161 21.0661 77.8011 18.9356 77.705C11.6987 77.705 7.2513 71.8629 7.2513 64.4187C7.2513 56.9746 11.6961 51.1324 18.9356 51.1324"/>
<path d="M60.8679 66.4289C60.8679 57.9512 56.1629 55.1085 49.6486 55.1085C46.9128 54.9464 44.2095 55.7697 42.0285 57.4292C39.8475 59.0887 38.3331 61.4746 37.7598 64.1546H44.2741C44.4365 62.9278 45.063 61.8099 46.0247 61.0311C46.9864 60.2522 48.2101 59.8716 49.4439 59.9676C52.4939 59.9676 54.2451 61.4661 54.2451 65.4485V66.2241L49.6967 66.6386C40.9083 67.3612 37.032 70.4643 37.032 75.23C37.032 79.5257 40.4433 83.0355 46.3359 83.0355C48.1021 83.2203 49.8817 82.8456 51.4233 81.9641C52.9649 81.0827 54.1908 79.7391 54.9274 78.1232C54.9737 79.6134 55.2166 81.0909 55.6499 82.5175H62.0077C61.2277 80.0429 60.8439 77.4605 60.8705 74.8661L60.8679 66.4289ZM54.2502 72.5288C54.3081 73.3267 54.1943 74.1278 53.9167 74.8782C53.6391 75.6285 53.2041 76.3107 52.6408 76.8788C52.0774 77.447 51.3989 77.8879 50.6509 78.1718C49.9029 78.4557 49.1028 78.5762 48.3044 78.525C45.1003 78.525 43.703 76.7158 43.703 74.8029C43.703 72.276 46.0301 71.0808 51.0434 70.7195L54.2475 70.5123L54.2502 72.5288Z"/>
<path d="M80.5899 55.1086C78.9415 55.0243 77.3004 55.3824 75.8369 56.1457C74.3734 56.909 73.1407 58.0497 72.2664 59.4497V55.6241H65.5979V82.4973H72.2664V67.7631C72.2664 62.9621 74.49 60.2684 78.2121 60.2684C81.4692 60.2684 83.2254 62.4921 83.2254 66.9369V82.4973H89.8939V65.9539C89.8939 58.5628 86.1186 55.0884 80.5873 55.0884"/>
<path d="M116.833 66.429C116.833 57.9514 112.128 55.1086 105.616 55.1086C102.88 54.9459 100.175 55.7689 97.9939 57.4285C95.8123 59.0881 94.2976 61.4743 93.7242 64.1548H100.239C100.401 62.9279 101.028 61.8101 101.989 61.0312C102.951 60.2523 104.175 59.8717 105.409 59.9678C108.458 59.9678 110.21 61.4662 110.21 65.4486V66.2243L105.661 66.6387C96.8727 67.3614 92.9966 70.4644 92.9966 75.2301C92.9966 79.5258 96.4079 83.0356 102.301 83.0356C104.067 83.2205 105.846 82.8457 107.388 81.9643C108.93 81.0828 110.155 79.7392 110.892 78.1234C110.938 79.6135 111.181 81.0911 111.614 82.5176H117.972C117.192 80.0431 116.808 77.4607 116.835 74.8662L116.833 66.429ZM110.215 72.5289C110.273 73.3269 110.159 74.128 109.881 74.8783C109.604 75.6287 109.169 76.3109 108.605 76.879C108.042 77.4471 107.364 77.888 106.616 78.1719C105.868 78.4559 105.067 78.5763 104.269 78.5251C101.065 78.5251 99.6676 76.7159 99.6676 74.8031C99.6676 72.2762 101.995 71.081 107.008 70.7196L110.212 70.5124L110.215 72.5289Z"/>
<path d="M140.007 59.1407C139.019 57.8649 137.748 56.8357 136.295 56.1342C134.842 55.4326 133.246 55.0778 131.632 55.0977C125.583 55.0977 120.009 59.8987 120.009 69.0561C120.009 78.1528 125.54 83.0146 131.632 83.0146C133.25 83.0375 134.852 82.6798 136.306 81.9705C137.761 81.2613 139.028 80.2202 140.007 78.9312V82.4991H146.675V46.3193H140.007V59.1407ZM133.338 77.8547C129.616 77.8547 126.67 74.7517 126.67 69.0663C126.67 63.3808 129.616 60.2777 133.338 60.2777C137.06 60.2777 140.007 63.3808 140.007 69.0663C140.007 74.7517 137.06 77.8547 133.338 77.8547Z"/>
<path d="M173.92 66.4289C173.92 57.9512 169.215 55.1085 162.703 55.1085C159.967 54.9464 157.264 55.7697 155.083 57.4292C152.902 59.0887 151.387 61.4746 150.814 64.1546H157.328C157.491 62.9278 158.118 61.8099 159.079 61.0311C160.041 60.2522 161.265 59.8716 162.499 59.9676C165.548 59.9676 167.3 61.4661 167.3 65.4485V66.2241L162.751 66.6386C153.963 67.3612 150.087 70.4643 150.087 75.23C150.087 79.5257 153.498 83.0355 159.391 83.0355C161.157 83.2203 162.936 82.8456 164.478 81.9641C166.02 81.0827 167.245 79.7391 167.982 78.1232C168.028 79.6134 168.271 81.091 168.704 82.5175H175.062C174.282 80.0429 173.898 77.4605 173.925 74.8661L173.92 66.4289ZM167.302 72.5288C167.36 73.3267 167.246 74.1278 166.969 74.8782C166.691 75.6285 166.256 76.3107 165.693 76.8788C165.129 77.447 164.451 77.8879 163.703 78.1718C162.955 78.4557 162.155 78.5762 161.356 78.525C158.15 78.525 156.755 76.7158 156.755 74.8029C156.755 72.276 159.082 71.0808 164.095 70.7195L167.3 70.5123L167.302 72.5288Z"/>
</svg>
  </div>
  <nav class="secondary-nav flex">
    <small>© 2025 Rail Industries Canada</small>
    <a class="small" href="/politique" target="_blank">Politique de confidentialité</a>
    <a class="small" href="https://caserne.com" target="_blank">Design par Caserne</a>
  </nav>
</footer>

<style lang="scss">
  footer {
    min-height: 50lvh;
    font-size: $s-1;

    small,
    .small {
      font-size: calc($s-1 - 1px);
    }

    .main-nav {
      margin-bottom: $s4;

      @media (max-width: $tablet_portrait) {
        margin-top: $s2;
      }

      a {
        transition: opacity 0.333s;

        &:hover,
        &:focus-visible {
          opacity: 0.75;
        }
      }
      
      .col {
        // flex: 1;

        &:first-child {
          margin-right: auto;
        }

        @media (max-width: $tablet_landscape) {
          &:last-child {
            margin-left: auto;
          }
        }

        hr {
          margin: 0;

          @media (max-width: $tablet_portrait) {
            margin-bottom: 2px;
          }
        }

        .h5 {
          margin-bottom: $s-2;
          min-width: 180px;
        }
      }
    }
  }

  .secondary-nav {
    @media (max-width: $tablet_portrait) {
      flex-direction: column;
      margin-top: calc($s2 * -1);
    }

    @media (min-width: $tablet_portrait) {
      gap: $s3;
      margin-top: calc($s0 * -1);
    }

    a,
    small {
      transition: opacity 0.333s;
      opacity: 0.75;

      &:hover,
      &:focus-visible {
        opacity: 1;
      }

      &:last-child {
        margin-left: auto;

        @media (max-width: $tablet_portrait) {
          margin: $s0 0;
        }
      }
    }
  }

  .svgs {
    margin-top: auto;
    position: relative;
    width: 100%;
    display: flex;
    align-items: flex-end;

    .svg--logo {
      @media (max-width: $tablet_portrait) {
        width: auto;
        height: 70px;
      }
    }

    .svg--logotype {
      position: absolute;
      top: 0;
      right: 0;

      @media (max-width: $tablet_portrait) {
        width: auto;
        height: 36px;
      }
    }

    .svg--bars {
      flex: 1;

      @media (max-width: $tablet_portrait) {
        width: auto;
        height: 24px;
      }
    }
  }
</style>